// lib/ingredientCategoryClassifier.ts
import type { CategoryKo } from "@/lib/ingredient";

// 카테고리별 키워드 매핑
const CATEGORY_KEYWORDS: Record<CategoryKo, string[]> = {
  야채: [
    // 일반 채소
    "상추", "양상추", "깻잎", "배추", "양배추", "청경채", "시금치", "근대",
    "부추", "쪽파", "파", "대파", "쑥갓", "미나리", "콩나물", "숙주",
    
    // 뿌리채소
    "당근", "무", "감자", "고구마", "토란", "연근", "우엉", "생강", "마늘", "양파",
    
    // 열매채소
    "토마토", "오이", "호박", "가지", "피망", "파프리카", "고추", "청양고추",
    "풋고추", "꽈리고추", "옥수수", "브로콜리", "콜리플라워",
    
    // 버섯류
    "버섯", "느타리버섯", "팽이버섯", "표고버섯", "양송이버섯", "새송이버섯",
    "목이버섯", "송이버섯",
    
    // 기타
    "고사리", "도라지", "더덕", "취나물", "아스파라거스", "샐러리",
    "양상추", "케일", "치커리", "비트", "래디시", "알배기배추"
  ],
  
  고기: [
    // 소고기
    "소고기", "쇠고기", "등심", "안심", "채끝", "목심", "갈비", "소갈비",
    "우둔", "설도", "양지", "사태", "차돌박이", "업진살",
    
    // 돼지고기
    "돼지고기", "삼겹살", "목살", "항정살", "가브리살", "앞다리", "뒷다리",
    "돼지갈비", "족발", "순대",
    
    // 닭고기
    "닭고기", "닭", "닭가슴살", "닭다리", "닭날개", "닭안심", "닭봉",
    
    // 기타 육류
    "오리고기", "양고기", "염소고기", "베이컨", "소시지", "햄", "스팸",
    "육포", "불고기", "다진고기", "갈은고기",
    
    // 해산물
    "생선", "고등어", "삼치", "갈치", "조기", "명태", "대구", "가자미",
    "광어", "우럭", "연어", "참치", "꽁치", "전갱이", "임연수어",
    "오징어", "낙지", "주꾸미", "문어", "쭈꾸미", "새우", "조개",
    "바지락", "모시조개", "홍합", "굴", "전복", "소라", "멍게",
    "해삼", "성게", "게", "꽃게", "대게"
  ],
  
  유제품: [
    // 우유류
    "우유", "두유", "저지방우유", "무지방우유", "초코우유", "딸기우유",
    "바나나우유", "커피우유", "연유",
    
    // 치즈
    "치즈", "모짜렐라치즈", "체다치즈", "까망베르치즈", "파마산치즈",
    "고다치즈", "크림치즈", "리코타치즈", "슬라이스치즈", "피자치즈",
    "스트링치즈",
    
    // 발효유
    "요거트", "요구르트", "그릭요거트", "플레인요거트", "떠먹는요거트",
    "마시는요거트", "야쿠르트", "비피더스",
    
    // 유제품 가공
    "버터", "생크림", "휘핑크림", "사워크림", "마스카포네",
    
    // 계란
    "계란", "달걀", "메추리알", "오리알", "훈제란", "구운란"
  ],
  
  조미료: [
    // 기본 양념
    "소금", "설탕", "후추", "식초", "간장", "된장", "고추장", "쌈장",
    "춘장", "청국장", "막장", "겨자", "와사비", "고춧가루", "참기름",
    "들기름", "식용유", "올리브유", "카놀라유", "포도씨유", "콩기름",
    
    // 장류
    "진간장", "양조간장", "국간장", "맛간장", "어간장", "액젓",
    "멸치액젓", "까나리액젓", "새우젓", "명란젓",
    
    // 분말 조미료
    "조미료", "다시다", "미원", "맛소금", "치킨스톡", "멸치가루",
    "새우가루", "파프리카가루", "카레가루", "카레",
    
    // 향신료
    "마늘", "생강", "계피", "팔각", "정향", "월계수잎", "로즈마리",
    "타임", "바질", "오레가노", "파슬리", "고수", "민트", "세이지",
    
    // 소스류
    "케첩", "마요네즈", "마요", "돈까스소스", "토마토소스", "칠리소스",
    "타바스코", "스리라차", "굴소스", "오이스터소스", "데리야끼소스",
    "바비큐소스", "머스타드", "핫소스",
    
    // 기타
    "미림", "맛술", "청주", "요리주", "꿀", "물엿", "올리고당", "메이플시럽",
    "조청", "전분", "녹말", "밀가루", "튀김가루", "부침가루", "빵가루",
    "베이킹파우더", "베이킹소다", "이스트", "효모"
  ],
  
  기타: [] // 기본값
};

//재료 이름으로 카테고리 분류
export function classifyIngredientCategory(ingredientName: string): CategoryKo {
  // 입력값 정규화 (공백 제거, 소문자 변환)
  const normalizedName = ingredientName.trim().toLowerCase();
  
  // 빈 문자열 체크
  if (!normalizedName) {
    return "기타";
  }
  
  // 각 카테고리의 키워드와 매칭
  for (const [category, keywords] of Object.entries(CATEGORY_KEYWORDS)) {
    // "기타"는 건너뛰기
    if (category === "기타") continue;
    
    for (const keyword of keywords) {
      const normalizedKeyword = keyword.toLowerCase();
      
      // 완전 일치 또는 포함 여부 확인
      if (
        normalizedName === normalizedKeyword ||
        normalizedName.includes(normalizedKeyword) ||
        normalizedKeyword.includes(normalizedName)
      ) {
        return category as CategoryKo;
      }
    }
  }
  
  // 매칭되는 키워드가 없으면 "기타"
  return "기타";
}

/**
 * 여러 재료를 한번에 분류
 */
export function classifyMultipleIngredients(
  ingredientNames: string[]
): Record<string, CategoryKo> {
  const result: Record<string, CategoryKo> = {};
  
  for (const name of ingredientNames) {
    result[name] = classifyIngredientCategory(name);
  }
  
  return result;
}